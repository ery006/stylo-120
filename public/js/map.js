var locs = {
	"locations": [
		{
			"lat": "32.876616",
			"long": "-117.231710",
			"name": "Coffee Shop",
			"description": "The Coffe Shop is a great area for people to come in and relax! The atmosphere is great for studying! It's nice and quiet allowing people to focus on their tasks! Also, their coffee is great too!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Address St. La Jolla, CA",
			"available_seating": "15",
			"total_seating": "20",
			"category": "home",
			"distance": "1",
			"price": "2",
			"wifi": "true",
			"sound": "quiet",
			"hour": "true",
			"imageURL": "https://cdn.vox-cdn.com/thumbor/cgG1ql9CDeWB_T36lIiowxPUALo=/0x0:1080x1079/1200x800/filters:focal(454x454:626x626)/cdn.vox-cdn.com/uploads/chorus_image/image/61907683/42849956_570627830022158_7099804199528040122_n.0.jpg"			
		},
		{
			"lat": "32.868518",
			"long": "-117.239889",
			"name": "The Great Library",
			"description": "This library has a wide variety of books and textbooks for students! There are three floors and many tables for students to come and study! Some floors may be a little loud due to large groups.",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Library Way, San Diego, CA",
			"available_seating": "40",
			"total_seating": "50",
			"category": "home",
			"distance": "4",
			"price": "6",
			"wifi": "true",
			"sound": "background",
			"hour": "true",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"	
		},
		{
			"lat": "32.875442",
			"long": "-117.237017",
			"name": "The Other Library",
			"description": "This library is smaller compared to other libraries in the area, but is a great quiet place for students to come and study! Space is limited though!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Address St. La Jolla, CA",
			"available_seating": "20",
			"total_seating": "22",
			"category": "home",
			"distance": "9",
			"price": "0",
			"wifi": "true",
			"sound": "background",
			"hour": "false",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"				
		},
		{
			"lat": "32.873855",
			"long": "-117.240900",
			"name": "Coffe Villa",
			"description": "Coffe Villa serves great coffee which will help keep you awake! It is a small cafe with limited seats.",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Address St. La Jolla, CA",
			"available_seating": "5",
			"total_seating": "20",
			"category": "home",
			"distance": "3",
			"price": "1",
			"wifi": "false",
			"sound": "loud",
			"hour": "flase",
			"imageURL": "https://images1.dallasobserver.com/imager/u/745xauto/10893224/communionneighborhoodcooperative_bethrankin_2153.jpg"				
		},
		{
			"lat": "32.876616",
			"long": "-117.241710",
			"name": "The Building of Success",
			"description": "A great place to study because of all the tables available to study! It can get a little loud because of its popularity, but it's still a great place!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Building St. La Jolla, CA",
			"available_seating": "3",
			"total_seating": "25",
			"category": "favorite",
			"distance": "5",
			"price": "7",
			"wifi": "true",
			"sound": "loud",
			"hour": "true",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"			
		},
		{
			"lat": "32.873999",
			"long": "-117.235622",
			"name": "The Heights",
			"description": "The Heights is a small coffee shop with a limited amount of seats. It is quiet and a great area to stay and study for a long amount of time.",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Heights St. La Jolla, CA",
			"available_seating": "20",
			"total_seating": "20",
			"category": "favorite",
			"distance": "2",
			"price": "9",
			"wifi": "true",
			"sound": "quiet",
			"hour": "false",
			"imageURL": "https://coffeeshopstartups.com/wp-content/uploads/2016/05/how-to-open-a-coffee-shop-business-1024x682.jpg"	
		},
		{
			"lat": "32.877531",
			"long": "-117.231631",
			"name": "The Cliffs",
			"description": "The CLiffs is a bakery shop with great snacks and drinks! It is quiet and has enough tables for groups up to 5, but come early to get a table!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Cliffs St. La Jolla, CA",
			"available_seating": "9",
			"total_seating": "20",
			"category": "favorite",
			"distance": "4",
			"price": "3",
			"wifi": "true",
			"sound": "quiet",
			"hour": "false",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"				
		},
		{
			"lat": "32.880883",
			"long": "-117.237553",
			"name": "Home Coffee",
			"description": "Home Coffee is a medium sized cafe that brews coffee to reminds people of home. There are comfortable seats and plenty of tables for people to come and enjoy their coffee and study hard.",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Home St. La Jolla, CA",
			"available_seating": "12",
			"total_seating": "20",
			"category": "favorite",
			"distance": "8",
			"price": "2",
			"wifi": "false",
			"sound": "background",
			"hour": "true",
			"imageURL": "https://pas-wordpress-media.s3.amazonaws.com/content/uploads/2018/01/coffee-shop-business-growth.jpg"				
		},
		{
			"lat": "32.874988",
			"long": "-117.234678",
			"name": "The Study Area",
			"class": "Cogs 120",
			"description": "This area is famous for being busy, but also having a lot of space for big groups of people. There will likely to a lot of noise, so be prepared to talk loudly if you are in a group!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Study St. La Jolla, CA",
			"available_seating": "9",
			"total_seating": "20",
			"category": "study",
			"distance": "4",
			"price": "13",
			"wifi": "true",
			"sound": "loud",
			"hour": "false",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"
		},
		{
			"lat": "32.875457",
			"long": "-117.238069",
			"name": "The Tunnel Bakery",
			"class": "Cse 170",
			"description": "Come through to study CSE 170 with your fellow peers. This bakery is a great area for large groups of people!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Tunnel St. La Jolla, CA",
			"available_seating": "14",
			"total_seating": "20",
			"category": "study",
			"distance": "1",
			"price": "10",
			"wifi": "true",
			"sound": "background",
			"hour": "true",
			"imageURL": "ttps://coffeeshopstartups.com/wp-content/uploads/2016/05/how-to-open-a-coffee-shop-business-1024x682.jpg"
		},
		{
			"lat": "32.879205",
			"long": "-117.236738",
			"name": "The New Place",
			"class": "Cogs 101a",
			"description": "COGS 101a is hard, so come study with some other people in the class. Let's do well together!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 New St. La Jolla, CA",
			"available_seating": "6",
			"total_seating": "20",
			"category": "study",
			"distance": "7",
			"price": "4",
			"wifi": "true",
			"sound": "background",
			"hour": "false",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"
		},
		{
			"lat": "32.870883",
			"long": "-117.237553",
			"name": "The Computer Labs",
			"class": "Cse 8a",
			"description": "Come study coding with us! We have a variety of experienced people so come through and lets learn together!",
			"hours": "Mon-Sat 8am-10pm",
			"address": "123 Labs St. La Jolla, CA",
			"available_seating": "16",
			"total_seating": "20",
			"category": "study",
			"distance": "6",
			"price": "4",
			"wifi": "true",
			"sound": "background",
			"hour": "false",
			"imageURL": "https://www.c-ville.com/wp-content/uploads/2015/05/Library_StephenBarling-660x335.jpg"
		}
	]
};
var markers = [];
var favMarkers = [];
var studyMarkers = [];



// Dialog functions
$( function() {
	$( "#dialog" ).dialog({
	  autoOpen: false,
	  show: {
	    effect: "blind",
	    duration: 1000
	  },
	  hide: {
	    effect: "blind",
	    duration: 1000
	  }
	});

	$( "#opener" ).on( "click", function() {
	  $( "#dialog" ).dialog( "open" );
	});
} );

$( function() {
	$( "#dialogColor" ).dialog({
	  autoOpen: false,
	  show: {
	    effect: "blind",
	    duration: 1000
	  },
	  hide: {
	    effect: "blind",
	    duration: 1000
	  }
	});

	$( "#openerColor" ).on( "click", function() {
	  $( "#dialogColor" ).dialog( "open" );
	});
} );

$( function() {
    $( 'input[type="radio"]' ).checkboxradio({
      icon: false
    });
  } );

// Slider distance
$( function() {
    $( "#slider-range-max-dist" ).slider({
      range: "max",
      min: 1,
      max: 20,
      value: 2,
      slide: function( event, ui ) {
        $( "#distance" ).val( ui.value + " mi" );
      }
    });
    $( "#distance" ).val( $( "#slider-range-max-dist" ).slider( "value" ) );
  } );

// Slider price
$( function() {
    $( "#slider-range-max-price" ).slider({
      range: "max",
      min: 0,
      max: 20,
      value: 2,
      slide: function( event, ui ) {
        $( "#price" ).val( "$" + ui.value );
      }
    });
    $( "#price" ).val( $( "#slider-range-max-price" ).slider( "value" ) );
  } );

function willDelete() {
	alert("This location will be deleted!");
}

function mySearch() {
	// console.log("he");
	for (i = 0; i < 5; i++) {
        var marker = markers[i];

        marker.setVisible(true);
    }

    for (i = 5; i < markers.length; i++) {
        var marker = markers[i];

        marker.setVisible(false);
    }
}

// Home screen map
function initMap() {
	// $.getJSON( "locations.json", function( json ) {
 //    locs = json;
	// });

	//console.log(locs);

	// Create an array of alphabetical characters used to label the markers.
	var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

	var currentPosition = new google.maps.LatLng(32.877281, -117.234929);

	var map = new google.maps.Map(document.getElementById('map'),  {
	    zoom: 15,
	    center: currentPosition,
	});

	var image = "https://img.icons8.com/color/26/000000/filled-star.png";
	var currrentLoc = new google.maps.Marker({
        	position: currentPosition,
        	map: map,
			icon: image
    });

    // Go get all locations
    var infowindow = new google.maps.InfoWindow();
    var marker, i;
	for(i = 0; i < locs.locations.length; i++) {
		var lat = parseFloat(locs.locations[i].lat);
		var long = parseFloat(locs.locations[i].long);
		var latlong = new google.maps.LatLng(lat, long);
		var myCategory = locs.locations[i].category;
		var myTitle = locs.locations[i].name;
		var available = parseFloat(locs.locations[i].available_seating);
		var total = parseFloat(locs.locations[i].total_seating);
		var myIcon = "https://maps.google.com/mapfiles/ms/icons/red-dot.png";
		//var infowindow = new google.maps.InfoWindow();
		if( (available / total) <= .3) {
			myIcon = "https://maps.google.com/mapfiles/ms/icons/green-dot.png"
		}
		else if( (available / total) <= .6) {
			myIcon = "https://maps.google.com/mapfiles/ms/icons/yellow-dot.png"
		}
		marker = new google.maps.Marker({
        	position: latlong,
        	map: map,
        	category: myCategory,
        	title: myTitle,
        	icon: myIcon
        	// label: labels[i]
    	});

    	if(locs.locations[i].category == "favorite") {
    		//console.l
			favMarkers.push(marker);
		}
		else if(locs.locations[i].category == "study") {
			studyMarkers.push(marker);
		}


		var contentString = '<div id="content">'+
	            '<div id="siteNotice">'+
	            '</div>'+
	            '<h4 id="firstHeading" class="firstHeading">' +
	            locs.locations[i].name + 
	            '</h4>'+
	            '<div id="bodyContent">'+
	            '<b>Description</b>' +
	            '<p>' + locs.locations[i].description + '</p>' +
							'</div>' +
							'<div>' +
	            '<p><b>Hours: </b>' + locs.locations[i].hours + '</p>' +
							'</div>' +
							'<div>' +
	            '<p>' + locs.locations[i].address + '</p>' +
							'</div>' +
							'<div>' +
	            '<div class=infoWindowOpen> Open </div>'+
							'</div>' +
							'<div>' +
	            '<p>' + locs.locations[i].avaiable_seating + ' Available seats.' + '</p>' +
							'</div>' +
							'<div> <img class="infoWindowImage" src=' +
							locs.locations[i].imageURL + '>'
							+
	            '<br/><a href="https://maps.google.com">' +
	            'Directions</a>'
							'</div>' +
	            '</div>'
							'</div>';

		// infowindow = new google.maps.InfoWindow({
		// content: contentString
		// });
		markers.push(marker);

		marker.contentString = contentString;
		google.maps.event.addListener(marker, 'click', (function(marker, i) {
			return function() {
			infowindow.setContent(this.contentString);
			infowindow.open(map, this);
			}
		})(marker, i));
		// marker.addListener('click', function() {
		// 	infowindow.setContent(contentString);
	 //      infowindow.open(map, marker);
	 //    });

	    

	}

}

function setFavGroups() {
	initMap();
	favoriteMap();
}

function setStudyGroups() {
	initMap();
	studyGroupsMap();
}

function homeMap() {
	for (i = 0; i < markers.length; i++) {
        var marker = markers[i];

        marker.setVisible(true);
    }
	 
}

function favoriteMap() {
	for (i = 0; i < markers.length; i++) {
        var marker = markers[i];
        // If is same category or category not picked
        if (marker.category == "favorite") {

            marker.setVisible(true);
        }
        // Categories don't match 
        else {
            marker.setVisible(false);
        }
    }
	 
}

function studyGroupsMap() {
	for (i = 0; i < markers.length; i++) {
        marker = markers[i];
        // If is same category or category not picked
        if (marker.category == "study") {
            marker.setVisible(true);
        }
        // Categories don't match 
        else {
            marker.setVisible(false);
        }
    }
}

function filterStudyMap() {
	var distance = $( "#distance" ).val();
	var price = $( "#price" ).val();
	var arr = [];
	var wifi = "";
	var hour = "";
	var sound = "";
	var myArr = [];

	// for(var i = 0; i < 3; i++) {
	// 	arr.push(false);
	// }
	// arr.push(true);
	// arr.push(true);

	price = price.replace("$", "");
	price = parseInt(price);
	distance = distance.replace("mi", "");
	distance = distance.replace(" ", "");
	distance = parseInt(distance);

	if ($('#wifi').is(":checked"))
	{
		wifi = "true";
	}

	if ($('#hour').is(":checked"))
	{
		hour = "true";
	}

	if ($('#radio-1').is(":checked"))
	{
		sound = "quiet";
	}

	else if ($('#radio-2').is(":checked"))
	{
		sound = "background";
	}

	else if ($('#radio-3').is(":checked"))
	{
		sound = "loud";
	}

	//console.log(studyMarkers);

	for (var i = 0; i < studyMarkers.length; i++) {
        marker = studyMarkers[i];
        var curSound = locs.locations[i].sound;
		var curPrice = locs.locations[i].price;
		var curWifi = locs.locations[i].wifi;
		var curHour = locs.locations[i].hour;
		var curDistance = locs.locations[i].distance;



		// for(var j = 0; j < 3; j++) {
		// 	if(arr[i] == true && !(myArr[i]) === (realArr[i])) {
		// 		setTrue = false;
		// 	}
		// }

		if(curPrice <= price && curDistance <= distance) {
			marker.setVisible(true);

		}
        
        // Categories don't match 
        else {
            marker.setVisible(false);
        }
    }
	$( "#dialog" ).dialog( "close" );
}

function filterFavMap() {
	var distance = $( "#distance" ).val();
	var price = $( "#price" ).val();
	var arr = [];
	var wifi = "";
	var hour = "";
	var sound = "";
	var myArr = [];

	// for(var i = 0; i < 3; i++) {
	// 	arr.push(false);
	// }
	// arr.push(true);
	// arr.push(true);

	price = price.replace("$", "");
	price = parseInt(price);
	distance = distance.replace("mi", "");
	distance = distance.replace(" ", "");
	distance = parseInt(distance);

	if ($('#wifi').is(":checked"))
	{
		wifi = "true";
	}

	if ($('#hour').is(":checked"))
	{
		hour = "true";
	}

	if ($('#radio-1').is(":checked"))
	{
		sound = "quiet";
	}

	else if ($('#radio-2').is(":checked"))
	{
		sound = "background";
	}

	else if ($('#radio-3').is(":checked"))
	{
		sound = "loud";
	}

	for (var i = 0; i < favMarkers.length; i++) {
        marker = favMarkers[i];
        var curSound = locs.locations[i].sound;
		var curPrice = locs.locations[i].price;
		var curWifi = locs.locations[i].wifi;
		var curHour = locs.locations[i].hour;
		var curDistance = locs.locations[i].distance;



		// for(var j = 0; j < 3; j++) {
		// 	if(arr[i] == true && !(myArr[i]) === (realArr[i])) {
		// 		setTrue = false;
		// 	}
		// }

		if(curPrice <= price && curDistance <= distance) {
			marker.setVisible(true);

		}
        
        // Categories don't match 
        else {
            marker.setVisible(false);
        }
    }
	$( "#dialog" ).dialog( "close" );
}

function filterMap() {
	var distance = $( "#distance" ).val();
	var price = $( "#price" ).val();
	var arr = [];
	var wifi = "";
	var hour = "";
	var sound = "";
	var myArr = [];

	// for(var i = 0; i < 3; i++) {
	// 	arr.push(false);
	// }
	// arr.push(true);
	// arr.push(true);

	price = price.replace("$", "");
	price = parseInt(price);
	distance = distance.replace("mi", "");
	distance = distance.replace(" ", "");
	distance = parseInt(distance);

	if ($('#wifi').is(":checked"))
	{
		wifi = "true";
	}

	if ($('#hour').is(":checked"))
	{
		hour = "true";
	}

	if ($('#radio-1').is(":checked"))
	{
		sound = "quiet";
	}

	else if ($('#radio-2').is(":checked"))
	{
		sound = "background";
	}

	else if ($('#radio-3').is(":checked"))
	{
		sound = "loud";
	}

	for (var i = 0; i < markers.length; i++) {
        marker = markers[i];
        var curSound = locs.locations[i].sound;
		var curPrice = locs.locations[i].price;
		var curWifi = locs.locations[i].wifi;
		var curHour = locs.locations[i].hour;
		var curDistance = locs.locations[i].distance;



		// for(var j = 0; j < 3; j++) {
		// 	if(arr[i] == true && !(myArr[i]) === (realArr[i])) {
		// 		setTrue = false;
		// 	}
		// }

		if(curPrice <= price && curDistance <= distance) {
			marker.setVisible(true);

		}
        
        // Categories don't match 
        else {
            marker.setVisible(false);
        }
    }
	$( "#dialog" ).dialog( "close" );
}
